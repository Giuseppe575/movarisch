<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MOVARISCH ‚Äì SDS Parser (PDF ‚Üí Tabella ‚Üí Excel)</title>
<link rel="stylesheet" href="style.css" />
<!-- Librerie: SheetJS e PDF.js (UMD). -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
</head>
<body>
<header>
  <h1>MOVARISCH ‚Äì Parser SDS da PDF</h1>
  <p class="sub">Carica le SDS/TDS in PDF ‚Üí estrazione H/EUH ‚Üí calcolo MOVARISCH ‚Üí esporta Excel</p>
</header>

<main>
  <section class="card">
    <div class="row">
      <label class="btn">
        <input type="file" id="pdfInput" accept="application/pdf" multiple />
        üìÑ Seleziona PDF SDS/TDS
      </label>
      <button class="btn" id="parseBtn" disabled>üîç Estrai & Calcola</button>
      <button class="btn" id="clearBtn">‚ôªÔ∏è Svuota</button>
      <button class="btn" id="testBtn">üß™ Test libreria</button>
      <button class="btn primary" id="exportBtn" disabled>‚¨áÔ∏è Esporta Excel</button>
    </div>
    <div class="risk-legend">
      <span class="legend-title">Classificazione del giudizio</span>
      <div class="legend-grid">
        <div class="legend-item">
          <div class="legend-range">0,1 ‚â§ R &lt; 15</div>
          <span class="badge b-irr">Irrilevante per la salute</span>
        </div>
        <div class="legend-item">
          <div class="legend-range">15 ‚â§ R &lt; 21</div>
          <span class="badge b-unc">Intervallo di incertezza<br/>E‚Äô necessario, prima della classificazione in rischio irrilevante per la salute, rivedere con scrupolo l‚Äôassegnazione dei vari punteggi, rivedere le misure di prevenzione e protezione adottate e consultare il medico competente per la decisione finale.</span>
        </div>
        <div class="legend-item">
          <div class="legend-range">21 ‚â§ R ‚â§ 40</div>
          <span class="badge b-sup">Rischio superiore al rischio chimico irrilevante per la salute<br/>Applicare gli articoli 225, 226, 229 e 230 D. Lgs 81/08 e s.m.i.</span>
        </div>
        <div class="legend-item">
          <div class="legend-range">40 &lt; R ‚â§ 80</div>
          <span class="badge b-elev">Rischio elevato</span>
        </div>
        <div class="legend-item">
          <div class="legend-range">R &gt; 80</div>
          <span class="badge b-grave">Rischio grave<br/>Riconsiderare il percorso dell‚Äôidentificazione delle misure di prevenzione e protezione ai fini di una loro eventuale implementazione. Intensificare i controlli quali la sorveglianza sanitaria, la misurazione degli agenti chimici e la periodicit√† della manutenzione.</span>
        </div>
      </div>
      <p class="mono default-note">Default indici ‚Üí Uso controllato, ventilazione localizzata, esposizione 15 min ‚Äì 2 h, quantit√† 1 ‚Äì 10 kg, livello di contatto "nessun contatto", distanza 1 ‚Äì 3 m (d = 0,75)</p>
    </div>
    <div id="alert"></div>
  </section>

  <section class="card" style="margin-top:14px">
    <table id="tbl">
      <thead>
        <tr>
          <th>File</th>
          <th>Nome commerciale</th>
          <th>Stato fisico</th>
          <th>H-codes (estratti)</th>
          <th class="num">SCORE</th>
          <th>Tipologia d'uso</th>
          <th>Tipologia di controllo</th>
          <th>Tempo di esposizione</th>
          <th>Quantit√† in uso</th>
          <th>Livello di contatto</th>
          <th class="num" title="Indice propriet√† chimico-fisiche (D)">D</th>
          <th class="num" title="Indice quantit√† in uso (Q)">Q</th>
          <th class="num" title="Indice tipologia d'uso (U)">U</th>
          <th class="num" title="Indice tipologia di controllo (C)">C</th>
          <th class="num" title="Indice tempo di esposizione (T)">T</th>
          <th class="num" title="Indice intensit√† inalatoria (I)">I</th>
          <th>Distanza operatore-sorgente</th>
          <th class="num">d</th>
          <th class="num">E<sub>inal</sub></th>
          <th class="num">E<sub>cut</sub></th>
          <th class="num">R<sub>inal</sub></th>
          <th class="num">R<sub>cut</sub></th>
          <th class="num">R<sub>tot</sub></th>
          <th>Giudizio</th>
          <th>‚Äî</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>
</main>

<footer>
  ¬© MOVARISCH Tool ‚Äì uso interno consulenza. Tutto offline nel browser. Nessun upload a server.
</footer>

<script src="app.js"></script>
</body>
</html>
